# Walmart_Store_Sales_Forecasting
## Problem Definition
მონაცემებში წარმოდგენილია Walmart-ის გაყიდვები 45 სხვადასხვა მაღაზიაში, რომლებიც სხვადასხვა რეგიონებში მდებარეობს. თითოეულ მაღაზიას აქვს რამდენიმე დეპარტამენტი და დავალებაა დეპარტამენტის ყოველკვირეული გაყიდვების პროგნოზი თითოეულ მათგანში.

Walmart მთელი წლის განმავლობაში აკეთებს სხვადასხვა ტიპის ფასდაკლებებს. ეს ფასდაკლებები წინ უსწრებს მნიშვნელოვან დღესასწაულებს: Super Bowl, Labor Day,Thanksgiving, ახალი წელი და შობა.

- train.csv - სატრენინგო მონაცემები (მაღაზია, დეპარტამენტი, თარიღი, გაყიდვები)
- test.csv - სატესტო მონაცემები პროგნოზისთვის
- features.csv - დამატებითი ფაქტორები (ტემპერატურა, საწვავის ფასი, CPI, უმუშევრობა, ფასდაკლებები)
- stores.csv - მაღაზიების მეტამონაცემები (ტიპი, ზომა)

კვლევის ძირითადი მიზანი იყო სხვადასხვა მოდელის ერთმანეთისთვის შედარება და მათი ანალიზი. ამიტომაც, შევარჩიე შემდეგი მოდელები:
- SARIMA
- DLinear
- XGBoost
- Linear Regression
- Random Forest
  
ჩემი  მიდგომა მოიცავდა შემდეგ ნაბიჯებს:

- მონაცემთა წინასწარი დამუშავება: მონაცემთა გაწმენდა, NaN-ების ჩანაცვლება/შევსება და კატეგორიული ცვლადების გარდაქმნა.
- feature-ების ინჟინერია: ახალი feature-ების შექმნა, რომლებიც ასახავს დროის ტენდენციებს, სეზონურობას და სხვა ფაქტორებს.
- მოდელების ტრენინგი: მოდელების დატრენინგება train data-ზე და მათი მეტრიკების შეფასება.
- ჰიპერპარამეტრების ოპტიმიზაცია: მოდელების მუშაობის გაუმჯობესება ჰიპერპარამეტრების ოპტიმიზაციის სხვადასხვა მეთოდის გამოყენებით.
- MLflow tracking: ექსპერიმენტების დალოგვა

## რეპოზიტორიის სტრუქტურა
1. model_experiment_DLinear.ipynb
2. model_experiment_SARIMA.ipynb
3. model_experiment_XGBoost.ipynb
4. model_inference_xgboost.ipynb
5. README.md
   
.ipynb ფაილები შეიცავს Notebook-ებს თითოეული მოდელისთვის, სადაც დეტალურადაა აღწერილი მონაცემთა დამუშავება, feature engineering/selection, მოდელის ტრენინგი და მათი მეტრიკები.

readme.md - პროექტის მიმოხილვა

## Feature Engineering
### კატეგორიული ცვლადების რიცხვითში გადაყვანა
- მაღაზიის ტიპი (Type): გარდავქმენი კატეგორიულ ცვლადად (category) და გამოვიყენე One-Hot Encoding (A, B, C ტიპებისთვის),ეს საშუალებას აძლევს მოდელს, გაითვალისწინოს მაღაზიის ტიპის გავლენა მის გაყიდვებზე.
- დღესასწაულის მაჩვენებელი (IsHoliday): გარდავქმენი ბინარულ ცვლადად (0/1), სადაც 1 მიუთითებს დღესასწაულზე და 0 ჩვეულებრივ დღეზე... გაერთიანების შედეგად წარმოქმნილი ორი IsHoliday სვეტი (IsHoliday_x, IsHoliday_y) გავაერთიანე ერთ სვეტად, ამოვიღე ზედმეტი სვეტები და გარდავქმენი int ტიპად.

### NAN მნიშვნელობების დამუშავება
- MarkDown სვეტები: MarkDown1-დან MarkDown5-მდე სვეტებში NaN მნიშვნელობები შევავსე 0-ით, რადგან ეს სვეტები წარმოადგენს ფასდაკლებებს, რომლებიც, თუ NaN-ია, ჩავთვალე 0-ად.
- CPI და უმუშევრობა (Unemployment): NaN მნიშვნელობები შევავსე თითოეული სვეტის მედიანური მნიშვნელობით, რათა თავიდან ამეცილებინა გადახრები მონაცემებში.

### Cleaning მიდგომები
- ამოვიღე ჩანაწერები, სადაც Weekly_Sales უარყოფითი იყო (შესაძლოა რამე შეცდომაა ან თანხის დაბრუნებას ნიშნავს, რაც არ გამომადგებოდა მოდელის დატრენინგებაში)
- Handling outliers: გამოვიყენე IQR (Interquartile Range) მეთოდი გაყიდვების outlier-ების 'დასაჭერად'.
- outlier-ები, რომლებიც არ იყო დღესასწაულის/ნოემბერ-დეკემბრის პერიოდში, შევცვალე ზედა ზღვრით, რათა თავიდან ამეცილებინა მოდელის overfitting.

## Feature Selection
- train_full და test_full დავალაგეთ Store, Dept და Date-ის მიხედვით, რათა სწორად გამოვთვალო ლაგ-ფიჩერები.
- გამოვიყენე კორელაციის ანალიზი, რათა გამოვავლინოთ ყველაზე მნიშვნელოვანი ფიჩერები.

<img width="1040" height="692" alt="image" src="https://github.com/user-attachments/assets/25f05a3f-363e-4a9c-a6d8-63276bc5888d" />

<img width="1039" height="462" alt="image" src="https://github.com/user-attachments/assets/af54590e-561c-4ee1-9769-42abaeaa9195" />

<img width="869" height="764" alt="image" src="https://github.com/user-attachments/assets/b65520a5-83c6-4c8a-8c60-0e69e8a90c8f" />















